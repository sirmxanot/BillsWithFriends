<%= form_for(setup_expense(@expense)) do |f| %>
  <% if @expense.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(@expense.errors.count, "error") %> prohibited this expense from being saved:</h2>

      <ul>
      <% @expense.errors.full_messages.each do |msg| %>
        <li><%= msg %></li>
      <% end %>
      </ul>
    </div>
  <% end %>

  <%= f.hidden_field :id -%>
  <%= f.hidden_field :user_id, :value => current_user.id -%>
  <%= f.hidden_field :created_at -%>

  

  <div class="form-stacked">
    <div class="field">
      <%= f.label :expense_name %><br />
      <%= f.text_field :expense_name %>
    </div>

    <div class="field">
      <%= f.label :date_incurred %><br />
      <%= f.date_select :date_incurred %>
    </div>

    <div class="field">
      <%= f.label :total_amount %><br />
      <%= f.text_field :total_amount%>
    </div>

    <div class="field">
      <%= f.label :memo %><br />
      <%= f.text_area :memo, :rows => 3 %>
    </div>

<h2>Participants</h2>
  <%= f.fields_for :you_owe_mes do |ff| %>
    
    <%= ff.hidden_field :id -%>
    <%= ff.hidden_field :expense_id, :value => @expense.id -%>
    <%= ff.hidden_field :creditor_id, :value => current_user.id -%>
    <%= ff.hidden_field :created_at -%>
    
    <div class="row show-grid" title="Half and half">
      <div class="span8">
        <div class="field">
          <%= ff.label :debtor_id %>
          <%= ff.text_field :debtor_id %>
          <% if ff.object.persisted? %>
            <%= ff.check_box :_destroy %>
            <%= ff.label :_destroy, "Destroy" %>
          <% end %>
        </div>
      </div>
      <div class="span8">
        <div class="field">
          <%= ff.label :amount %>
          <%= ff.text_field :amount %>
        </div>
      </div> 
     
    </div>
  <% end %>




    

    <div class="actions">
      <%= f.submit %>
    </div>
  </div>

<% end %>
